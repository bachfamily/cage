<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<?xml-stylesheet href="./_c74_ref.xsl" type="text/xsl"?>

<!--This file has been automatically generated by Doctor Max. DO NOT EDIT THIS FILE DIRECTLY.-->

<c74object name="cage.granulate" module="cage" kind="patcher">

	<digest>
		Perform symbolic granulation
	</digest>

	<description>
		Performs real-time symbolic granulation of a given original
		<o>bach.roll</o>, depending on grain size, onset region, time interval
		and grain density.
	</description>

	<!--METADATA-->
	<metadatalist>
		<metadata name="author">cageproject</metadata>
		<metadata name="tag">cage</metadata>
		<metadata name="tag">cage electrospectral</metadata>
	</metadatalist>

	<!--INLETS-->
	<inletlist>
		<inlet id="0" type="INLET_TYPE">
			<digest>
				Start/stop metronome
			</digest>
			<description>
			</description>
		</inlet>
		<inlet id="1" type="INLET_TYPE">
			<digest>
				Messages from original <o>bach.roll</o>
			</digest>
			<description>
			</description>
		</inlet>
		<inlet id="2" type="INLET_TYPE">
			<digest>
				Time interval (ms)
			</digest>
			<description>
			</description>
		</inlet>
		<inlet id="3" type="INLET_TYPE">
			<digest>
				Grain size (ms)
			</digest>
			<description>
			</description>
		</inlet>
		<inlet id="4" type="INLET_TYPE">
			<digest>
				Onset region start and end (ms)
			</digest>
			<description>
			</description>
		</inlet>
	</inletlist>

	<!--OUTLETS-->
	<outletlist>
		<outlet id="0" type="INLET_TYPE">
			<digest>
				Messages for output <o>bach.roll</o>
			</digest>
			<description>
			</description>
		</outlet>
		<outlet id="1" type="INLET_TYPE">
			<digest>
				Current grain start and end (ms)
			</digest>
			<description>
			</description>
		</outlet>
		<outlet id="2" type="INLET_TYPE">
			<digest>
				Messages for original <o>bach.roll</o>
			</digest>
			<description>
			</description>
		</outlet>
	</outletlist>

	<!--ARGUMENTS-->
	<objarglist>
		<objarg name="time_interval" optional="1" type="llll">
			<digest>
				Time interval
			</digest>
			<description>
				The optional first argument sets the initial fixed time interval (if it is a
				single number) or minimum and maximum time interval (if it is a wrapped list of 2 elements),
				in milliseconds.
				Also see <m>int</m> and <m>list</m>.
			</description>
		</objarg>
		<objarg name="grain_size" optional="1" type="llll">
			<digest>
				Grain size (ms)
			</digest>
			<description>
				The optional second argument sets the initial grain size (if it is a
				single number) or minimum and maximum grain size (if it is a wrapped list of 2 elements),
				in milliseconds.
				Also see <m>int</m> and <m>list</m>.
			</description>
		</objarg>
		<objarg name="onset_region" optional="1" type="llll">
			<digest>
				Onset region start and end (ms)
			</digest>
			<description>
				The optional third argument sets the initial onset region start and end, in
				milliseconds (it is thus expected to be a wrapped list of two elements). Also see <m>list</m>.
			</description>
		</objarg>
	</objarglist>

	<!--MESSAGES-->
	<methodlist>
		<method name="bang">
			<arglist />
			<digest>
				Output result
			</digest>
			<description>
				Output the result obtained from the most recently received input data.
			</description>
		</method>
		<method name="int">
			<arglist />
			<digest>
				Turn granulation on/off, set time interval or grain size
			</digest>
			<description>
				In the first inlet, any integer other than <m>0</m> clears the
				data in the output <o>bach.roll</o> and starts the granulation, thus sending for each grain:
				the proper messages to the output <o>bach.roll</o> from the first outlet, and the current
				grain start and end (in milliseconds) from the second outlet, as well as all the needed
				messages for the original <o>bach.roll</o> from the third outlet.
				<m>0</m> stops the granulation. <br />
				An <m>int</m> in the second inlet sets the (fixed) time interval for picking
				grains (in milliseconds, exactly as for <o>metro</o>).
				Also see the <m>list</m> message. <br />
				An <m>int</m> in the third inlet sets the (fixed) grain size (in milliseconds).
				Also see the <m>list</m> message. <br />
			</description>
		</method>
		<method name="list">
			<arglist />
			<digest>
				Set time interval, grain size or onset region
			</digest>
			<description>
				A <m>list</m> in the third inlet is expected to contain two elements:
				the minimum and maximum time interval for picking grains
				(in milliseconds, exactly as for <o>metro</o>).
				The time interval will be chosen randomly between these two values.
				Also see the <m>int</m> message. <br />
				A <m>list</m> in the fourth inlet is expected to contain two elements: the minimum and
				maximum grain size (in milliseconds).
				The grain size will be chosen randomly between these two values.
				Also see the <m>int</m> message. <br />
				A <m>list</m> in the fifth inlet is expected to contain the starting and ending
				point of the region where the grain onsets should lie (in milliseconds).
				The grain onset will be chosen randomly between these two values.
			</description>
		</method>
		<method name="llll">
			<arglist />
			<digest>
				Retrieve <o>bach.roll</o> messages
			</digest>
			<description>
				Second inlet should be connected to the first
				<o>bach.roll</o> outlet, and will receive the <m>llll</m> messages coming from it. <br />
				An <m>llll</m> in any other inlet will be converted into a <m>int</m> or <m>list</m>.
			</description>
		</method>
	</methodlist>

	<!--ATTRIBUTES-->
	<attributelist>
		<attribute name="align" get="1" set="1" type="int" size="1">
			<digest>
				Align Grain Start To
			</digest>
			<description>
				Toggles the ability to align beginning of grains with chords onsets (1) or markers onset (2).
				Default is 0 (no alignment).
			</description>
			<attributelist>
				<attribute name="label" get="1" set="1" type="symbol" size="1" value="Align Grain Start To" />
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="enumindex" />
			</attributelist>
		</attribute>
		<attribute name="inscreenpos" get="1" set="1" type="float" size="1">
			<digest>
				
			</digest>
			<description>
			</description>
			<attributelist>
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="text" />
			</attributelist>
		</attribute>
		<attribute name="play" get="1" set="1" type="int" size="1">
			<digest>
				Also Play
			</digest>
			<description>
				Toggles the ability to also play the granulated content (with a delay set via the <m>playdelay</m> attribute).
				By default it is off.
			</description>
			<attributelist>
				<attribute name="label" get="1" set="1" type="symbol" size="1" value="Also Play" />
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="onoff" />
			</attributelist>
		</attribute>
		<attribute name="playdelay" get="1" set="1" type="float" size="1">
			<digest>
				Play Delay
			</digest>
			<description>
				If <m>play</m> is on, sets the delay between the writing cursor and the playing cursor, i.e.
				the delay before play starts. Defaults to 250ms.
			</description>
			<attributelist>
				<attribute name="label" get="1" set="1" type="symbol" size="1" value="Play Delay" />
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="text" />
			</attributelist>
		</attribute>
		<attribute name="rate" get="1" set="1" type="float" size="1">
			<digest>
				Granulation Rate
			</digest>
			<description>
				Sets a time multiplier for each grain, so that they can be stretched.
				Defaults to 1.
			</description>
			<attributelist>
				<attribute name="label" get="1" set="1" type="symbol" size="1" value="Granulation Rate" />
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="text" />
			</attributelist>
		</attribute>
		<attribute name="refresh" get="1" set="1" type="int" size="1">
			<digest>
				Current Instant Relative Position in Domain
			</digest>
			<description>
			</description>
			<attributelist>
				<attribute name="label" get="1" set="1" type="symbol" size="1" value="Current Instant Relative Position in Domain" />
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="text" />
			</attributelist>
		</attribute>
		<attribute name="trans" get="1" set="1" type="float_array" size="0">
			<digest>
				Transposition
			</digest>
			<description>
				Sets a transposition coefficient (in midicents) for each grain.
				If just a number is provided, this is a fixed transposition. If two numbers are
				provided, these are the minimum and maximum transposition, the actual value
				being chosen randomly for each grain between them.
			</description>
			<attributelist>
				<attribute name="label" get="1" set="1" type="symbol" size="1" value="Transposition" />
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="text" />
			</attributelist>
		</attribute>
		<attribute name="vel" get="1" set="1" type="" size="1">
			<digest>
				
			</digest>
			<description>
				When a new data must be output or when a refresh operation is performed
				(see <m>refresh</m> attribute), the horizontal scrollbar position of the connected
				<o>bach.roll</o> (if any and if its horizontal scrollbar is visible) is changed
				in order for the "current instant" to be at a certain point inside the notation
				object domain. This point is a number between 0. and 1. defined by this attribute,
				0. meaning: at the beginning of the displayed portion of score, and 1. meaning:
				at the end of the displayed portion of score. (This is the very same parameter
				that one encounters with <o>bach.roll</o>'s inscreenpos message.) Defaults to 0.7.
			</description>
			<attributelist>
				<attribute name="style" get="1" set="1" type="symbol" size="1" value="text" />
			</attributelist>
		</attribute>
	</attributelist>

	<!--SEEALSO-->
	<seealsolist>
		<seealso name="bach.roll" />
		<seealso name="bach.score" />
	</seealsolist>

	<misc name = "Input">
		<entry name ="Inlet 1 (int)">
			<description>
				Start/stop metronome.
			</description>
		</entry>
		<entry name ="Inlet 2 (llll)">
			<description>
				Messages from original <o>bach.roll</o>.
			</description>
		</entry>
		<entry name ="Inlet 3 (int/list)">
			<description>
				Time interval (ms).
			</description>
		</entry>
		<entry name ="Inlet 4 (int/list)">
			<description>
				Grain size (ms).
			</description>
		</entry>
		<entry name ="Inlet 5 (list)">
			<description>
				Onset region start and end (ms).
			</description>
		</entry>
	</misc>

	<misc name = "Output">
		<entry name ="Outlet 1 (llll)">
			<description>
				Messages for output <o>bach.roll</o>.
			</description>
		</entry>
		<entry name ="Outlet 2 (list)">
			<description>
				Current grain start and end (ms).
			</description>
		</entry>
		<entry name ="Outlet 3 (list)">
			<description>
				Messages for original <o>bach.roll</o>.
			</description>
		</entry>
	</misc>

</c74object>